'use client';

import React, { useContext, useState, useEffect, useRef } from 'react';
import { CursorContext } from '@/components/Cursor/CursorProvider';
import { getMoonPhase, swedenFullMoons2025 } from '@/scripts/moon';
import { quotes, deepQuotes, fullmoonQuotes } from '@/scripts/erika';
import { initSky } from '@/scripts/sky';
import './page.scss';

const Home = () => {
  const [showLoadingSection, setShowLoadingSection] = useState(true);
  const { setSize } = useContext(CursorContext);
  const [moonPhase, setMoonPhase] = useState({ src: '', phase: '' });
  const poemRef = useRef(null);
  const deepBtnRef = useRef(null);
  const oneMoreBtnRef = useRef(null);
  const writerTokenRef = useRef(0);
  const currentSourceRef = useRef(
    () => quotes[Math.floor(Math.random() * quotes.length)]
  );

  useEffect(() => {
    const CHAR_DELAY = 45;
    const FADE_DURATION = 300;

    const today = new Date();
    const currentMoon = getMoonPhase(
      today.getFullYear(),
      today.getMonth() + 1,
      today.getDate()
    );
    setMoonPhase(currentMoon);

    const makeRotator = (arr, key) => {
      const ORDER_KEY = `${key}-order`;
      const POINTER_KEY = `${key}-ptr`;
      return () => {
        let order = JSON.parse(localStorage.getItem(ORDER_KEY));
        let pointer = parseInt(localStorage.getItem(POINTER_KEY), 10);
        if (!order || order.length !== arr.length) {
          order = [...Array(arr.length).keys()].sort(() => Math.random() - 0.5);
          pointer = 0;
        }
        const idx = order[pointer];
        pointer = (pointer + 1) % arr.length;
        localStorage.setItem(ORDER_KEY, JSON.stringify(order));
        localStorage.setItem(POINTER_KEY, pointer.toString());
        return arr[idx];
      };
    };

    const regularQuote = makeRotator(quotes, 'erika');
    const deepQuote = makeRotator(deepQuotes, 'erika-deep');
    const fullQuote = makeRotator(fullmoonQuotes, 'erika-full');

    const todayISO = new Date().toISOString().split('T')[0];
    const isFullMoon = swedenFullMoons2025.includes(todayISO);
    let initialSource = isFullMoon ? fullQuote : regularQuote;

    // Set the current source getter function
    currentSourceRef.current = () => initialSource();

    const typeWriter = (text, el) => {
      if (!el) return;
      writerTokenRef.current += 1;
      const currentToken = writerTokenRef.current;
      el.innerHTML = '';

      const write = (i) => {
        if (writerTokenRef.current !== currentToken) return;
        if (i >= text.length) return;

        if (text[i] === '\n') {
          el.appendChild(document.createElement('br'));
          return write(i + 1);
        }
        const span = document.createElement('span');
        span.textContent = text[i];
        span.style.opacity = '0';
        span.style.transition = `opacity ${FADE_DURATION}ms ease`;
        el.appendChild(span);
        requestAnimationFrame(() => (span.style.opacity = '1'));
        setTimeout(
          () => write(i + 1),
          text[i] === ' ' ? CHAR_DELAY / 2 : CHAR_DELAY
        );
      };

      write(0);
    };

    const showInitialQuote = () => {
      typeWriter(currentSourceRef.current(), poemRef.current);
    };

    const handleDeepClick = () => {
      currentSourceRef.current = () => deepQuote();
      typeWriter(currentSourceRef.current(), poemRef.current);
    };

    const handleOneMoreClick = () => {
      typeWriter(currentSourceRef.current(), poemRef.current);
    };

    showInitialQuote();

    deepBtnRef.current?.addEventListener('click', handleDeepClick);
    oneMoreBtnRef.current?.addEventListener('click', handleOneMoreClick);

    return () => {
      deepBtnRef.current?.removeEventListener('click', handleDeepClick);
      oneMoreBtnRef.current?.removeEventListener('click', handleOneMoreClick);
    };
  }, []);

  useEffect(() => {
    const timer = setTimeout(() => {
      setShowLoadingSection(false);
    }, 5800);
    return () => clearTimeout(timer);
  }, []);

  useEffect(() => {
    initSky();
  }, []);

  return (
    <main className='main'>
      <div className='overlay'></div>
      <div className='underlay'></div>
      <button
        onClick={() => {
          localStorage.setItem('showSplashAgain', 'true');
          window.location.reload(); // This will reload and RootLayout will see the flag
        }}
        className='see-intro-again-button'
      >
        See Intro Again
      </button>

      <svg
        className='erika'
        width='274'
        height='350'
        viewBox='0 0 274 350'
        fill='none'
        xmlns='http://www.w3.org/2000/svg'
      >
        <path d='M180.312 305.457C179.779 306.391 179.912 306.524 180.845 305.991C182.445 305.057 182.979 303.857 181.912 303.857C181.512 303.857 180.845 304.524 180.312 305.457Z' />
        <path d='M169.312 306.457C168.779 307.391 168.912 307.524 169.845 306.991C171.445 306.057 171.979 304.857 170.912 304.857C170.512 304.857 169.845 305.524 169.312 306.457Z' />
        <path d='M164.5 317.291C164.5 318.358 165.167 318.891 165.833 318.491C166.633 317.958 166.9 317.025 166.5 316.358C165.3 314.491 164.5 314.891 164.5 317.291Z' />
        <path d='M153.154 322.791C153.688 323.191 154.488 323.191 155.021 322.791C155.421 322.257 155.021 321.857 154.088 321.857C153.154 321.857 152.754 322.257 153.154 322.791Z' />
        <path d='M14.4 2.52851C12 4.26185 7.73333 6.92851 5.06667 8.52851C2.26667 9.99518 0 11.4618 0 11.7285C0 11.8618 3.46667 11.4618 7.73333 10.7952C17.0667 9.06185 23.6 9.19518 25.8667 11.0618C26.8 11.8618 28.1333 11.9952 28.8 11.4618C29.4667 10.9285 29.6 11.0618 29.0667 11.5952C28.1333 12.7952 36 20.5285 38.1333 20.5285C38.8 20.5285 42.1333 23.3285 45.6 26.7952C49.0667 30.2618 52 32.3952 52 31.5952C52 30.6618 51.4667 29.5952 50.6667 29.1952C50 28.7952 49.3333 27.7285 49.3333 26.9285C49.3333 25.1952 60.2667 34.9285 61.6 37.7285C62.2667 39.4618 62.5333 39.4618 62.5333 37.9952C62.6667 36.9285 61.3333 34.6618 59.7333 32.9285C58.1333 31.1952 57.4667 29.8618 58.2667 29.8618C59.0667 29.8618 61.8667 32.2618 64.4 35.0618C67.7333 38.7952 69.8667 40.1285 71.7333 39.5952C73.2 39.3285 74.8 39.5952 75.2 40.3952C75.7333 41.1952 77.6 41.8618 79.3333 41.8618C81.0667 41.8618 83.0667 42.9285 83.7333 44.1285C84.9333 46.2618 85.2 46.2618 87.3333 44.1285C88.6667 42.6618 89.2 40.7952 88.6667 38.9285C88 35.9952 88 36.1285 90 39.1952C92 42.2618 92 42.2618 91.3333 39.4618C90.8 37.7285 91.0667 36.5285 91.8667 36.5285C92.6667 36.5285 93.3333 35.8618 93.3333 35.1952C93.3333 34.3952 92.5333 33.8618 91.4667 33.8618C90.5333 33.8618 88.9333 32.9285 88 31.8618C86.1333 29.5952 71.0667 21.8618 68.5333 21.8618C67.7333 21.8618 65.7333 20.6618 64 19.1952C62.2667 17.7285 60.2667 16.5285 59.3333 16.5285C58.5333 16.5285 56.5333 15.3285 54.9333 13.7285C53.2 12.2618 51.2 11.1952 50.2667 11.5952C49.3333 11.8618 43.8667 9.59518 38 6.52851C23.7333 -0.938153 20.1333 -1.60482 14.4 2.52851Z' />
        <path d='M238.401 25.4612C237.067 25.8612 236.001 26.5279 236.001 27.1946C236.001 27.7279 233.467 27.7279 230.401 26.9279C225.867 25.9946 224.401 26.1279 223.334 27.7279C221.867 29.5946 208.267 31.0612 185.334 31.5946C181.067 31.7279 176.934 32.6612 175.467 33.8612C168.801 39.0612 166.667 41.8612 166.801 45.4612C166.801 47.4612 167.201 48.3946 167.601 47.4612C168.667 44.7946 170.667 45.5946 170.667 48.7946C170.801 51.8612 170.801 51.8612 172.934 49.1946C174.934 46.6612 174.934 46.6612 174.134 50.1279C173.201 54.1279 173.067 54.1279 182.134 54.5279C185.067 54.6612 188.267 55.1946 189.067 55.7279C189.867 56.2612 193.201 55.8612 196.267 54.9279C199.467 53.9946 202.667 53.1946 203.334 53.0612C207.334 52.2612 210.667 50.6612 210.667 49.5946C210.667 48.7946 212.134 48.6612 213.867 49.0612C215.734 49.4612 217.601 49.0612 218.534 47.9946C220.001 46.2612 227.734 43.7279 234.001 42.9279C235.467 42.6612 236.934 42.1279 237.334 41.5946C237.734 41.0612 241.467 40.2612 245.601 39.7279L253.201 38.7946L260.801 46.6612C265.067 51.0612 268.134 53.4612 267.601 52.1279C266.667 49.5946 267.601 49.3279 270.667 51.0612C275.067 53.9946 274.401 50.6612 269.734 46.9279C266.934 44.6612 265.734 43.1946 267.201 43.7279C269.601 44.5279 269.601 44.3946 267.334 41.0612C265.467 38.1279 265.334 37.3279 266.801 36.3946C268.267 35.4612 268.134 35.1946 266.267 35.1946C264.534 35.1946 264.001 34.5279 264.534 32.7946C265.201 30.7946 263.867 30.1279 256.267 28.2612C244.134 25.3279 241.067 24.7946 238.401 25.4612ZM170.667 41.9946C169.734 43.4612 168.801 44.3946 168.401 43.9946C168.001 43.5946 168.401 42.3946 169.334 41.1946C171.734 38.3946 172.401 38.6612 170.667 41.9946Z' />
        <path d='M266.666 31.1954C266.666 32.1288 267.066 32.5288 267.599 32.1288C267.999 31.5954 267.999 30.7954 267.599 30.2621C267.066 29.8621 266.666 30.2621 266.666 31.1954Z' />
        <path d='M196.801 57.5949C196.401 58.2616 196.934 58.7949 198.001 58.7949C199.067 58.7949 199.601 58.2616 199.201 57.5949C198.801 57.0616 198.267 56.5283 198.001 56.5283C197.734 56.5283 197.201 57.0616 196.801 57.5949Z' />
        <path d='M201.733 57.4617C202.266 57.8617 203.066 57.8617 203.599 57.4617C203.999 56.9284 203.599 56.5284 202.666 56.5284C201.733 56.5284 201.333 56.9284 201.733 57.4617Z' />
        <path d='M184.667 64.1283C184.267 65.3283 182.934 65.5949 180.934 65.1949C178.8 64.6616 177.067 65.3283 174.667 67.7283C171.334 71.4616 167.334 72.2616 166.267 69.4616C165.867 68.6616 165.467 69.4616 165.467 71.4616C165.334 74.2616 164.667 75.1949 162.667 75.1949C161.2 75.1949 160 75.7283 160 76.3949C160 77.0616 158.4 79.3283 156.4 81.4616C154.267 83.7283 151.334 88.2616 149.6 91.5949C146.934 96.9283 146.667 98.9283 147.467 106.795C147.867 111.728 148.4 116.795 148.534 117.862C148.8 121.195 153.467 127.062 156.4 127.862C160.667 129.062 165.734 131.595 167.734 133.462C170.267 135.862 175.2 135.728 174.267 133.328C173.6 131.728 174 131.728 177.067 133.328C179.067 134.395 181.6 135.195 182.8 135.195C184 135.195 187.2 136.128 189.734 137.195C195.334 139.595 201.334 139.862 201.334 137.728C201.334 136.928 199.6 135.595 197.334 134.795C192.534 132.928 191.734 129.462 196.534 130.662C198.667 131.195 199.867 130.795 200.534 129.195C200.934 127.862 202.267 127.195 203.2 127.595C204.267 127.995 205.867 127.462 206.667 126.395C207.6 125.328 209.467 124.528 210.8 124.528C212.134 124.528 213.6 123.862 214.134 122.928C214.8 121.862 213.867 121.728 210.534 122.395C208 122.795 205.734 123.862 205.6 124.528C205.067 125.995 202.667 124.928 202.667 123.328C202.667 122.262 214 119.728 216.4 120.262C216.934 120.395 217.2 119.728 217.067 118.928C216.8 117.862 218.4 117.062 221.067 116.795C223.467 116.528 225.067 115.862 224.667 115.062C224.134 114.395 225.2 113.862 226.934 113.862C240.8 113.862 242.667 113.728 244.534 111.728C247.734 108.528 248.934 105.595 248.667 100.795C248.4 95.9949 246.4 93.8616 241.734 93.8616C240.134 93.8616 234 91.7283 228.134 89.1949C213.467 83.0616 194 80.9283 186.267 84.7949C183.467 86.1283 180.8 86.9283 180.134 86.6616C179.6 86.2616 177.867 86.7949 176.534 87.7283C174.667 89.1949 173.467 89.3283 171.334 88.1283C169.867 87.3283 168.267 86.7949 167.734 86.9283C165.6 87.4616 166.8 84.5283 169.334 82.9283C170.8 81.9949 172 80.6616 172 79.8616C172 79.1949 176.8 75.4616 182.667 71.8616C188.534 68.1283 193.334 64.3949 193.334 63.4616C193.334 61.1949 185.6 61.8616 184.667 64.1283ZM228.4 91.9949C233.067 94.3949 234.8 96.5283 233.867 98.1283C233.067 99.4616 227.334 98.1283 222 95.4616C217.867 93.3283 216 93.0616 207.334 92.6616C202 92.3949 202 92.3949 204.934 89.9949C207.334 87.9949 208.934 87.7283 216 88.6616C220.4 89.3283 226 90.7949 228.4 91.9949ZM222.667 103.862C229.334 107.328 227.067 111.462 216.267 115.595C208.667 118.662 208.534 118.528 212.667 113.728C214.534 111.328 216.534 107.728 216.934 105.728C217.734 101.195 217.6 101.328 222.667 103.862ZM184.667 109.462C185.734 113.062 183.2 113.595 179.2 110.662C176.667 108.662 176.667 108.662 179.334 106.662C182.267 104.528 183.2 105.062 184.667 109.462ZM162 110.395C162 111.728 163.334 113.328 164.934 113.995C167.467 114.928 170.667 118.928 170.667 121.062C170.667 121.462 169.2 121.862 167.334 121.862C163.2 121.862 156.4 115.728 155.2 110.795C154.4 107.195 154.534 107.062 158.134 107.462C160.934 107.728 162 108.662 162 110.395ZM198.267 122.795C197.734 123.195 196.934 123.195 196.4 122.795C196 122.262 196.4 121.862 197.334 121.862C198.267 121.862 198.667 122.262 198.267 122.795Z' />
        <path d='M32.6668 65.0613L27.3335 66.9279L33.7335 66.2613C45.2001 64.9279 64.1335 71.5946 58.8001 75.0613C57.2001 76.1279 57.2001 76.6613 58.5335 78.3946C60.1335 80.2613 59.8668 80.5279 56.1335 80.5279C53.8668 80.5279 52.0001 79.9946 52.0001 79.3279C52.0001 77.3279 39.8668 76.9279 31.3335 78.7946C15.7335 81.8613 4.93347 87.1946 14.0001 87.1946C15.8668 87.1946 17.8668 88.2613 18.6668 89.8613C20.5335 93.3279 22.6668 93.3279 21.7335 89.8613C21.2001 87.7279 22.2668 86.6613 27.3335 84.5279C30.8001 83.0613 33.7335 81.8613 34.1335 81.8613C34.4001 81.8613 34.2668 84.5279 33.7335 87.8613C33.2001 91.9946 33.4668 93.8613 34.5335 93.8613C35.3335 93.8613 36.0001 95.5946 36.0001 97.5946C36.0001 101.595 37.6001 102.795 46.0001 105.461C48.6668 106.261 49.8668 107.461 49.6001 108.928C49.3335 110.261 50.1335 111.195 51.3335 111.195C52.4001 111.195 53.3335 109.995 53.3335 108.528C53.3335 106.795 54.6668 105.595 58.1335 104.661C62.9335 103.328 66.6668 103.861 66.6668 105.995C66.6668 106.661 65.2001 107.195 63.3335 107.195C61.4668 107.195 59.6001 107.995 59.2001 109.061C58.8001 110.128 57.7335 110.795 56.6668 110.395C55.7335 109.995 54.6668 110.661 54.2668 111.728C53.3335 114.128 55.3335 115.861 56.6668 113.861C57.0668 113.195 58.1335 112.528 58.9335 112.528C61.4668 112.528 55.6001 117.328 52.9335 117.595C49.4668 117.728 48.6668 118.795 50.4001 120.928C51.4668 122.128 54.1335 122.395 59.8668 121.861C64.2668 121.461 67.7335 121.595 67.6001 122.261C67.4668 122.928 68.6668 123.995 70.2668 124.661C72.8001 125.595 73.7335 125.195 75.4668 122.528C77.8668 118.795 80.0001 118.128 80.0001 121.195C80.0001 122.261 80.9335 123.195 82.1335 123.195C83.6001 123.195 84.0001 122.528 83.4668 120.928C82.9335 119.595 82.9335 119.061 83.4668 119.461C84.5335 120.528 88.5335 116.795 90.0001 113.195C91.0668 110.661 91.2001 110.661 91.7335 113.595C92.6668 119.061 94.9335 115.995 98.2668 105.061C101.067 95.7279 101.2 93.8613 99.7335 88.1279C98.9335 84.6613 97.4668 81.8613 96.5335 81.8613C95.6001 81.8613 94.5335 80.7946 94.0001 79.4613C92.8001 75.7279 86.8001 69.7279 83.7335 69.1946C82.1335 68.7946 80.5335 67.9946 80.1335 67.3279C79.7335 66.6613 78.5335 66.9279 77.7335 67.9946C76.4001 69.3279 76.4001 69.9946 78.4001 71.0613C80.5335 72.2613 80.4001 72.3946 78.0001 72.5279C76.5335 72.5279 73.6001 72.6613 71.3335 72.7946C69.2001 72.9279 63.3335 71.1946 58.4001 68.9279C47.6001 63.8613 39.8668 62.6613 32.6668 65.0613ZM68.5335 93.7279C70.1335 95.4613 70.4001 96.5279 69.3335 97.1946C68.6668 97.5946 68.2668 98.5279 68.6668 99.1946C69.2001 100.128 62.8001 102.528 62.0001 101.595C61.3335 100.928 64.5335 91.1946 65.4668 91.1946C65.8668 91.1946 67.3335 92.3946 68.5335 93.7279ZM89.3335 99.5946C91.2001 99.5946 93.3335 101.595 93.3335 103.328C93.3335 104.795 88.1335 110.128 86.4001 110.395C85.4668 110.528 83.3335 111.328 81.7335 112.261C77.0668 114.795 74.4001 114.261 74.9335 110.795C75.2001 108.795 76.6668 107.461 79.6001 106.528C85.3335 104.661 85.8668 103.995 84.0001 100.395C82.5335 97.7279 82.6668 97.5946 84.8001 98.5279C86.2668 99.0613 88.2668 99.5946 89.3335 99.5946ZM71.4668 122.795C70.1335 124.128 68.9335 122.128 70.1335 120.395C70.9335 118.928 71.2001 118.928 71.7335 120.395C72.0001 121.328 71.8668 122.395 71.4668 122.795Z' />
        <path d='M17.0673 70.6613C14.934 71.7279 13.334 72.9279 13.334 73.1946C13.334 74.6613 15.8673 73.7279 18.8007 71.1946C22.6673 68.1279 22.0007 67.8613 17.0673 70.6613Z' />
        <path d='M232.401 116.129C232.934 116.529 233.734 116.529 234.267 116.129C234.667 115.595 234.267 115.195 233.334 115.195C232.401 115.195 232.001 115.595 232.401 116.129Z' />
        <path d='M88.5326 126.128C87.9993 127.062 88.1326 127.195 89.066 126.662C90.666 125.728 91.1993 124.528 90.1326 124.528C89.7326 124.528 89.066 125.195 88.5326 126.128Z' />
        <path d='M68.001 130.528C66.9343 131.728 66.9343 132.528 67.7343 132.528C69.3343 132.528 71.201 129.995 70.2676 129.062C70.001 128.795 68.9343 129.328 68.001 130.528Z' />
        <path d='M149.334 132.528C149.334 133.462 149.734 133.862 150.267 133.462C150.667 132.928 150.667 132.128 150.267 131.595C149.734 131.195 149.334 131.595 149.334 132.528Z' />
        <path d='M211.067 132.129C211.6 132.529 212.4 132.529 212.933 132.129C213.333 131.595 212.933 131.195 212 131.195C211.067 131.195 210.667 131.595 211.067 132.129Z' />
        <path d='M176 136.528C176 137.462 176.4 137.862 176.933 137.462C177.333 136.928 177.333 136.128 176.933 135.595C176.4 135.195 176 135.595 176 136.528Z' />
        <path d='M203.067 137.462C203.6 137.862 204.4 137.862 204.933 137.462C205.333 136.928 204.933 136.528 204 136.528C203.067 136.528 202.667 136.928 203.067 137.462Z' />
        <path d='M155.467 173.195C154.934 175.328 154.134 178.128 153.734 179.195C153.201 180.262 152.934 182.395 153.067 183.862C154.801 208.528 155.201 211.195 156.534 210.795C157.334 210.395 159.067 211.195 160.534 212.395C162.934 214.395 162.934 214.395 162.001 211.195C161.067 208.262 161.201 208.128 163.201 209.728C164.401 210.662 165.334 212.262 165.334 213.062C165.334 213.862 167.067 217.195 169.334 220.395C172.401 225.195 173.334 225.995 174.134 224.128C174.534 222.928 174.534 220.395 174.134 218.528C173.467 215.862 173.867 215.062 176.667 214.395C178.534 213.995 180.001 213.062 180.001 212.395C180.001 211.728 179.201 211.595 178.267 211.995C177.201 212.395 175.734 211.728 174.801 210.662C173.867 209.595 172.267 209.062 171.334 209.328C170.001 209.862 169.734 209.195 170.267 207.062C170.801 205.195 170.534 204.395 169.734 204.928C168.801 205.462 167.867 203.862 167.334 200.795C166.801 198.128 165.867 195.195 165.067 194.262C164.401 193.328 164.134 191.995 164.667 191.062C165.601 189.728 160.534 176.795 158.534 175.195C158.001 174.795 157.334 173.328 157.067 171.862C156.534 169.728 156.267 169.862 155.467 173.195Z' />
        <path d='M65.3342 179.195C63.2009 181.329 61.3342 183.462 61.3342 183.862C61.3342 184.262 59.6009 187.062 57.3342 189.995C55.2009 193.062 53.7342 196.129 54.1342 196.795C54.6675 197.595 55.4675 197.462 56.1342 196.395C56.6675 195.462 56.9342 194.262 56.6675 193.862C56.4009 193.329 57.3342 193.062 58.8009 193.195C61.8675 193.462 64.2675 196.395 63.0675 198.529C62.5342 199.462 62.8009 199.462 63.7342 198.529C65.3342 196.929 72.0009 179.729 72.0009 177.062C72.0009 174.129 69.7342 174.795 65.3342 179.195Z' />
        <path d='M77.7333 206.661C76.8 209.328 79.4667 211.195 84.4 211.195C86.5333 211.195 89.4667 211.861 90.9333 212.661C94.1333 214.395 93.3333 212.528 88.9333 207.461C85.7333 203.995 78.9333 203.461 77.7333 206.661Z' />
        <path d='M127.867 213.728C120.001 221.595 120.401 222.261 134.001 222.395C137.734 222.528 140.934 222.128 141.334 221.728C141.734 221.328 143.734 220.128 145.867 219.061C150.001 217.061 150.134 214.795 146.001 214.128C144.667 213.995 143.067 213.328 142.667 212.661C141.734 211.195 136.534 208.528 134.534 208.528C133.734 208.528 130.667 210.795 127.867 213.728Z' />
        <path d='M73.334 212.662C73.334 213.462 75.0673 214.662 77.334 215.329C81.734 216.929 82.6673 216.929 82.6673 215.462C82.534 213.995 73.334 211.062 73.334 212.662Z' />
        <path d='M152.668 213.862C153.068 214.529 154.134 215.195 154.801 215.195C155.601 215.195 155.734 214.529 155.334 213.862C154.934 213.062 153.868 212.529 153.201 212.529C152.401 212.529 152.268 213.062 152.668 213.862Z' />
        <path d='M110.667 216.395C110.667 217.062 109.467 217.862 107.867 218.262C106.267 218.662 105.467 219.595 105.867 220.395C106.4 221.062 106.133 221.995 105.333 222.529C104.667 222.929 104 222.662 104 221.862C104 221.062 102.667 220.529 101.067 220.795C98.8001 221.062 98.0001 222.129 98.0001 224.795C97.8667 226.795 97.4667 228.795 97.0667 229.329C96.5334 229.729 96.8001 231.329 97.7334 232.662C98.8001 234.395 100.133 234.929 102.267 234.395C104.667 233.729 105.333 234.129 105.467 235.995C105.467 237.462 105.867 237.862 106.267 236.795C106.533 235.995 107.467 235.195 108.133 235.195C108.933 235.195 109.067 235.729 108.667 236.529C108.267 237.195 109.067 237.862 110.667 237.862C112.267 237.862 113.2 238.395 112.8 238.929C112.533 239.462 113.6 240.129 115.333 240.262C117.333 240.395 118.533 239.595 119.067 237.729C119.733 235.462 119.467 235.329 117.867 236.662C116.133 238.129 116 237.729 116.8 234.395C118 229.462 118.533 228.795 120 231.195C120.667 232.262 121.6 232.662 122.133 232.129C122.667 231.595 122.133 230.129 120.933 228.795C119.6 227.462 118.667 225.729 118.667 224.929C118.667 224.129 117.733 222.795 116.667 221.862C115.467 220.929 114.933 219.062 115.333 217.729C116 215.862 115.467 215.195 113.467 215.195C111.867 215.195 110.667 215.729 110.667 216.395Z' />
        <path d='M173.333 227.195C171.733 228.261 171.733 228.661 173.599 230.795C174.799 232.128 176.133 234.928 176.666 237.195C177.199 239.328 178.799 243.861 180.266 247.195C182.266 251.595 183.066 255.995 183.066 263.461C183.066 269.195 183.199 273.861 183.466 273.861C183.733 273.861 184.533 271.328 185.333 268.128C186.133 265.061 187.199 261.595 187.599 260.528C188.533 257.995 188.666 255.195 187.733 252.528C187.333 251.461 185.599 246.661 183.999 241.861C182.266 237.061 180.133 232.528 179.199 231.728C178.133 230.928 177.333 229.195 177.333 227.995C177.333 225.595 176.266 225.328 173.333 227.195Z' />
        <path d='M102.666 243.195C102.666 244.129 103.066 244.529 103.599 244.129C103.999 243.595 103.999 242.795 103.599 242.262C103.066 241.862 102.666 242.262 102.666 243.195Z' />
        <path d='M109.867 246.128C109.467 246.662 108.4 246.795 107.467 246.395C106.267 245.995 105.467 246.928 105.067 249.062C104.667 250.928 104.8 252.528 105.467 252.528C106.8 252.528 115.867 246.795 116 245.862C116 244.662 110.533 244.928 109.867 246.128Z' />
        <path d='M137.334 255.195C137.334 256.129 137.734 256.529 138.267 256.129C138.667 255.595 138.667 254.795 138.267 254.262C137.734 253.862 137.334 254.262 137.334 255.195Z' />
        <path d='M34.9338 258.129C35.3338 259.062 37.0672 260.129 39.0672 260.662C41.0672 261.195 43.4672 262.395 44.5338 263.462C48.5338 267.329 52.1338 269.862 53.3338 269.862C54.1338 269.862 54.6672 270.395 54.6672 271.195C54.6672 271.862 55.3338 272.529 56.1338 272.529C56.8005 272.529 57.0672 271.862 56.5338 270.929C56.0005 269.995 56.1338 269.862 57.0672 270.395C57.8672 270.929 59.8672 270.662 61.3338 269.862C63.3338 268.795 64.0005 268.795 64.0005 269.995C64.0005 270.929 65.2005 271.195 67.4672 270.662C69.4672 270.129 70.5338 270.262 70.1338 271.062C69.7338 271.729 71.8672 272.662 74.9338 273.195C78.1338 273.729 82.8005 275.329 85.3338 276.662C87.8672 278.129 91.8672 279.195 94.2672 279.195C97.6005 279.195 98.6672 279.729 98.6672 281.595C98.6672 282.929 99.4672 284.129 100.534 284.129C101.601 284.129 102.134 283.329 101.734 282.262C100.934 280.129 108.667 279.729 110.001 281.862C110.667 282.929 111.467 282.795 112.801 281.729C113.867 280.929 116.401 280.529 118.401 280.929C120.534 281.329 124.401 281.195 127.201 280.529C131.201 279.595 132.401 279.862 132.934 281.462C133.734 283.329 134.001 283.329 135.467 281.329C136.534 279.862 137.334 279.595 138.001 280.529C138.401 281.195 139.467 281.462 140.267 281.062C141.201 280.395 141.467 281.329 140.801 283.729C140.401 285.595 140.134 287.195 140.267 287.195C140.534 287.195 142.534 286.662 144.934 285.995C148.401 285.062 149.067 285.062 148.401 286.662C147.734 288.395 145.201 289.195 142.134 288.662C141.467 288.529 140.534 288.929 140.134 289.595C138.401 291.995 129.467 296.529 126.534 296.529C123.467 296.395 123.467 296.395 125.867 294.529C127.334 293.462 129.601 292.529 130.934 292.529C132.267 292.529 133.334 291.862 133.334 291.195C133.334 290.395 134.534 289.862 135.867 289.862C137.334 289.862 138.934 289.195 139.467 288.262C140.134 287.329 139.734 287.062 138.401 287.595C137.201 287.995 133.601 289.062 130.534 289.862C127.334 290.795 123.601 291.995 122.401 292.662C121.067 293.329 118.801 293.862 117.334 293.862C115.734 293.862 114.801 294.395 115.201 295.062C115.601 295.729 115.067 296.662 113.867 297.062C111.467 297.995 106.667 295.729 106.667 293.595C106.667 292.662 107.201 292.662 108.534 293.729C109.734 294.795 110.667 294.795 111.201 293.995C112.267 292.395 108.001 289.995 105.734 290.795C104.801 291.195 104.001 290.795 104.001 289.995C104.001 289.062 102.934 289.062 100.534 289.862C96.6672 291.329 94.5338 289.729 92.0005 283.462C91.3338 281.862 90.1338 280.529 89.3338 280.529C87.6005 280.529 87.6005 282.795 89.3338 283.862C90.4005 284.529 90.2672 285.329 89.2005 286.662C88.4005 287.595 87.2005 288.129 86.5338 287.729C85.8672 287.329 85.3338 288.262 85.3338 289.729C85.3338 292.262 86.6672 293.195 89.7338 292.662C90.2672 292.662 90.6672 293.195 90.6672 294.129C90.6672 295.329 91.0672 295.329 92.2672 294.129C94.2672 292.129 98.6672 291.995 98.6672 293.862C98.6672 294.529 98.0005 295.195 97.2005 295.195C96.4005 295.195 96.1338 296.129 96.5338 297.329C97.0672 298.795 96.8005 299.329 95.4672 298.795C90.2672 296.795 84.2672 296.395 83.3338 297.995C81.8672 300.262 86.2672 303.195 91.2005 303.329C94.1338 303.462 94.5338 303.729 92.5338 304.129C90.9338 304.395 88.5338 305.862 87.3338 307.195C85.2005 309.595 85.3338 309.729 90.2672 311.062C95.8672 312.662 100.801 316.795 99.4672 318.929C99.0672 319.729 100.267 320.662 102.401 321.195C107.201 322.395 107.201 322.262 107.334 318.795C107.334 316.662 108.267 315.729 110.667 315.462C112.534 315.195 114.934 314.662 116.001 314.262C117.067 313.862 118.534 313.595 119.201 313.729C119.734 313.862 121.867 312.929 123.601 311.729C125.467 310.662 128.001 309.862 129.467 310.262C130.801 310.662 134.001 310.529 136.401 309.862C139.334 309.329 141.734 309.462 143.067 310.529C144.801 311.729 146.667 311.862 150.667 310.795C156.534 309.195 157.467 307.862 153.467 306.529C151.067 305.862 149.334 302.529 148.667 297.462C148.534 295.995 149.201 295.195 150.801 295.195C152.267 295.195 153.334 294.262 153.334 293.195C153.334 292.129 154.267 291.195 155.334 291.195C156.401 291.195 157.334 290.395 157.334 289.462C157.334 288.662 159.867 286.795 163.067 285.462C169.601 282.795 172.001 282.662 172.001 284.662C172.001 285.462 173.334 285.862 175.067 285.595C177.201 285.329 178.134 284.129 178.401 281.462C178.667 279.462 179.467 277.862 180.134 277.862C180.801 277.862 181.334 277.195 181.334 276.395C181.334 275.595 180.401 275.195 179.334 275.729C178.001 276.262 177.334 275.595 177.334 273.862C177.334 272.395 176.401 271.195 175.334 271.195C174.267 271.195 173.334 270.662 173.334 270.129C173.334 269.595 171.734 268.929 169.867 268.795C167.867 268.662 165.467 267.862 164.534 267.195C163.467 266.129 162.801 266.262 162.401 267.195C161.334 270.529 138.534 267.462 130.534 263.062C127.067 261.195 122.667 260.395 113.067 260.129C108.134 259.995 106.267 260.529 104.801 262.529C103.067 265.062 102.801 265.062 100.401 262.929C97.4672 260.129 90.9338 258.929 90.2672 260.929C90.0005 261.729 88.8005 261.995 87.4672 261.462C86.2672 260.929 85.6005 259.862 86.1338 259.062C86.6672 257.995 86.0005 257.862 84.0005 258.529C82.0005 259.195 81.3338 259.062 81.8672 257.995C82.4005 257.195 82.1338 256.529 81.3338 256.529C80.4005 256.529 80.0005 257.462 80.5338 258.529C80.9338 259.595 80.2672 261.462 79.0672 262.662C77.0672 264.662 76.6672 264.662 75.2005 262.529C74.1338 261.062 72.5338 260.529 71.3338 261.062C70.1338 261.462 68.4005 261.462 67.6005 260.929C66.8005 260.529 61.6005 259.862 56.1338 259.729C50.5338 259.462 43.8672 258.662 41.3338 257.995C35.3338 256.129 34.2672 256.129 34.9338 258.129ZM83.6005 261.462C83.0672 261.862 82.2672 261.862 81.7338 261.462C81.3338 260.929 81.7338 260.529 82.6672 260.529C83.6005 260.529 84.0005 260.929 83.6005 261.462ZM164.934 282.795C164.401 283.195 163.601 283.195 163.067 282.795C162.667 282.262 163.067 281.862 164.001 281.862C164.934 281.862 165.334 282.262 164.934 282.795ZM102.267 296.129C101.734 296.529 100.934 296.529 100.401 296.129C100.001 295.595 100.401 295.195 101.334 295.195C102.267 295.195 102.667 295.595 102.267 296.129Z' />
        <path d='M76 259.062C76 259.862 76.6667 260.795 77.3333 261.195C78.1333 261.595 78.6667 261.062 78.6667 259.995C78.6667 258.795 78.1333 257.862 77.3333 257.862C76.6667 257.862 76 258.395 76 259.062Z' />
        <path d='M64 287.061C64 287.728 64.6667 288.795 65.3333 289.195C66.1333 289.595 66.6667 289.461 66.6667 288.661C66.6667 287.995 66.1333 286.928 65.3333 286.528C64.6667 286.128 64 286.261 64 287.061Z' />
        <path d='M176.267 289.329C175.333 290.395 175.2 291.329 176 291.862C176.8 292.262 177.333 292.129 177.333 291.462C177.333 290.662 178.533 290.395 180 290.795C181.467 291.195 182.667 290.929 182.667 290.129C182.667 287.995 178.133 287.462 176.267 289.329Z' />
        <path d='M72 293.862C72 294.529 72.6667 295.195 73.4667 295.195C74.1333 295.195 74.4 294.529 74 293.862C73.6 293.062 72.9333 292.529 72.5333 292.529C72.2667 292.529 72 293.062 72 293.862Z' />
        <path d='M77.7326 296.129C78.2659 296.529 79.0659 296.529 79.5992 296.129C79.9992 295.595 79.5992 295.195 78.6659 295.195C77.7326 295.195 77.3326 295.595 77.7326 296.129Z' />
        <path d='M106.4 325.462C107.333 325.862 108.533 325.728 108.933 325.328C109.466 324.928 108.666 324.528 107.2 324.662C105.733 324.662 105.333 325.062 106.4 325.462Z' />
        <path d='M96 328.529C96 330.262 98.4 331.462 99.2 329.995C99.6 329.329 99.0667 328.529 98 327.995C96.9333 327.595 96 327.862 96 328.529Z' />
        <path d='M114.666 328.528C114.666 329.462 115.066 329.862 115.599 329.462C115.999 328.928 115.999 328.128 115.599 327.595C115.066 327.195 114.666 327.595 114.666 328.528Z' />
        <path d='M103.334 333.728C102.534 335.195 104.534 336.795 105.867 335.595C107.067 334.395 106.8 332.528 105.467 332.528C104.667 332.528 103.867 333.061 103.334 333.728Z' />
        <path d='M108 338.528C109.6 340.528 112 340.128 112 337.728C112 337.061 110.666 336.528 109.2 336.528C106.8 336.528 106.666 336.795 108 338.528Z' />
        <path d='M122.666 337.728C122.666 338.528 123.333 339.461 123.999 339.861C124.799 340.261 125.333 339.728 125.333 338.661C125.333 337.461 124.799 336.528 123.999 336.528C123.333 336.528 122.666 337.061 122.666 337.728Z' />
        <path d='M101.334 339.195C101.334 340.129 101.734 340.529 102.267 340.129C102.667 339.595 102.667 338.795 102.267 338.262C101.734 337.862 101.334 338.262 101.334 339.195Z' />
        <path d='M86.3993 340.128C83.4659 340.928 82.2659 344.395 84.5326 345.328C85.5993 345.728 88.2659 345.061 90.5326 343.861C96.7993 340.661 93.9993 338.128 86.3993 340.128ZM86.2659 344.128C85.7326 344.528 84.9326 344.528 84.3993 344.128C83.9993 343.595 84.3993 343.195 85.3326 343.195C86.2659 343.195 86.6659 343.595 86.2659 344.128Z' />
        <path d='M74.6667 341.862C73.0667 342.929 73.3334 343.195 75.7334 343.195C77.4667 343.195 78.4 342.662 78 341.862C77.0667 340.262 77.2 340.262 74.6667 341.862Z' />
      </svg>

      <div className='svg'>
        <svg viewBox='0 0 201.33 202.05' xmlns='http://www.w3.org/2000/svg'>
          <defs>
            <linearGradient
              id='linearGradient12950'
              x1='125.3'
              x2='-73.179'
              y1='112.09'
              y2='229.18'
              gradientTransform='translate(-4.9976 -36.054)'
              gradientUnits='userSpaceOnUse'
            >
              <stop stopColor='#f8f8f8' offset='0' />
              <stop stopColor='#7d7d7d' stopOpacity='0' offset='1' />
            </linearGradient>
          </defs>
          <path
            id='line1'
            className='line'
            d='m98.701 1.0913c-0.17564 35.326-0.70705 35.288-0.55934 104.5-0.98149 63.191-0.94097 63.228-0.51204 95.759'
          />
          <path
            id='line2'
            className='line'
            d='m99.238 1.7849c3.7511 32.869 80.683 75.31-4.4858 106.02-87.976 41.542 2.1632 61.642 3.4149 93.881'
          />
          <g transform='translate(-5.3546 -35.697)'>
            <path
              id='line3'
              className='line'
              d='m104.42 37.502c-3.7511 32.869-83.895 76.024 1.273 106.74 87.976 41.542-1.8062 61.285-3.0579 93.524'
            />
          </g>
        </svg>
      </div>

      <div className='imageHolder'>
        {moonPhase.src && <img src={moonPhase.src} alt='Moon Phase' />}
        {/*  <div id='phase'>{moonPhase.phase}</div> */}
      </div>

      <div className='poem-wrapper'>
        <div ref={poemRef} className='poem'></div>
      </div>

      <div className='video-bg'>
        <video autoPlay muted loop>
          <source src='/sky.webm' type='video/webm' />
        </video>
      </div>

      <div className='button-wrapper'>
        <button ref={deepBtnRef} className='deep-btn'>
          It’s safe, share the deeper ones
        </button>
        <button ref={oneMoreBtnRef} className='deep-btn'>
          One more
        </button>
      </div>
    </main>
  );
};

export default Home;
